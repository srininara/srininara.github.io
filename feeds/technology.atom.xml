<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Starting Point - Technology</title><link href="https://www.nacnez.com/" rel="alternate"></link><link href="https://www.nacnez.com/feeds/technology.atom.xml" rel="self"></link><id>https://www.nacnez.com/</id><updated>2012-07-03T00:00:00+05:30</updated><entry><title>Setting up a nginx virtual host on Ubuntu</title><link href="https://www.nacnez.com/nginx-ubuntu.html" rel="alternate"></link><published>2012-07-03T00:00:00+05:30</published><updated>2012-07-03T00:00:00+05:30</updated><author><name>Srinivas Narayanan</name></author><id>tag:www.nacnez.com,2012-07-03:/nginx-ubuntu.html</id><summary type="html">&lt;p&gt;How to set up a nginx virtual host on Ubuntu&lt;/p&gt;</summary><content type="html">&lt;p&gt;I had heard of &lt;a href="http://www.nginx.org/"&gt;nginx&lt;/a&gt; as a very good web server from the perspective of performance. So I decided to try it out for one of my learning endeavors.&lt;/p&gt;
&lt;h2 id="installation"&gt;Installation&lt;/h2&gt;
&lt;p&gt;Installation of nginx on my &lt;a href="http://www.ubuntu.com/"&gt;Ubuntu&lt;/a&gt; was a breeze. Nginx is available as part of the Ubuntu distribution from Canonical. So I could just search the &lt;a href="http://en.wikipedia.org/wiki/Ubuntu_Software_Center"&gt;Ubuntu Software Center&lt;/a&gt; and install it on my machine. Once installed, starting and stopping the nginx server is simple. Just open the &lt;a href="https://help.ubuntu.com/community/UsingTheTerminal"&gt;terminal&lt;/a&gt;, and use the following commands&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sudo nginx&lt;/code&gt; (starts the server)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo nginx -s quit&lt;/code&gt; (stops the server)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo nginx -h&lt;/code&gt; (provides basic usage help)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;One thing to notice is that you have to execute these commands with superuser privileges (sudo).&lt;/p&gt;
&lt;h2 id="setting-up-the-virtual-host"&gt;Setting up the virtual host&lt;/h2&gt;
&lt;p&gt;Being able to run the nginx server is all good. But for me to use it, I needed a virtual host where I can put my development site's content.&lt;/p&gt;
&lt;p&gt;Using the &lt;a href="http://www.google.co.in/"&gt;readily available and trusted resource&lt;/a&gt;, I reached a &lt;a href="http://articles.slicehost.com/2008/5/16/ubuntu-hardy-nginx-virtual-hosts"&gt;link&lt;/a&gt; which talked about this. After reading the same and some experimentation, I was able to set the virtual host. Below is a brief description of the steps which I followed:&lt;/p&gt;
&lt;h3 id="folder-structure"&gt;Folder Structure&lt;/h3&gt;
&lt;p&gt;Once nginx is set up, you find the following folder where definitions of the virtual hosts are kept:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The folder structure is as depicted below:&lt;/p&gt;
&lt;p&gt;&lt;img alt="Nginx folder structure" src="https://www.nacnez.com/images/nginx-folders1.png" style="width: 550px; height: auto; max-width: 100%;"/&gt;&lt;/p&gt;
&lt;p&gt;The important folders for our discussion are &lt;code&gt;sites-available&lt;/code&gt; and &lt;code&gt;sites-enabled&lt;/code&gt;. For all sites which are to be hosted by nginx inside the current machine, an entry needs to be made inside the &lt;code&gt;sites-available&lt;/code&gt; folder.  A file needs to be created which holds the configuration and the name of file is the domain name. For example, I can create a file - &lt;code&gt;ex.nacnez.com&lt;/code&gt; which represents the domain name using which the virtual host can be accessed. The contents of the configuration file are as follows (remember this is just the basic stuff - more configuration is possible but for setting up the virtual host this is good enough):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;listen&lt;/span&gt;   &lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;server_name&lt;/span&gt; &lt;span class="n"&gt;example&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;access_log&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;docroot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;basepath&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;access&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;error_log&lt;/span&gt;  &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;docroot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;basepath&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;root&lt;/span&gt;   &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;docroot&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;basepath&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;public&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;index&lt;/span&gt;  &lt;span class="k"&gt;index&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here &lt;code&gt;/home/your/docroot/basepath&lt;/code&gt; means the base path under which you want to store your site and its document root folders.&lt;/p&gt;
&lt;h3 id="setting-up-the-actual-document-root"&gt;Setting up the actual document root&lt;/h3&gt;
&lt;p&gt;The contents of your site is generally placed under its document root folder.&lt;/p&gt;
&lt;p&gt;&lt;img alt="nginx docroot folders" src="https://www.nacnez.com/images/nginx-docroot-folders.png" style="width: 300px; height: auto; max-width: 100%;"/&gt;&lt;/p&gt;
&lt;p&gt;If you look at the configuration above you can understand where the document root of your site is placed. Under the &lt;code&gt;public&lt;/code&gt; folder is where your index file (&lt;code&gt;index.html&lt;/code&gt; as per the above configuration and which could contain any HTML content) and other website artifacts go. Anybody accessing your web server through the above domain (of course there is more work to be done for that) is taken to this folder. The log folder is used to store logs like &lt;code&gt;access&lt;/code&gt; and &lt;code&gt;error&lt;/code&gt; logs. There are a couple of other folders (&lt;code&gt;private&lt;/code&gt; and &lt;code&gt;backup&lt;/code&gt;) but they are not used for simple setups (and I don't even know how they are going to be used - may be something for a future post).&lt;/p&gt;
&lt;h3 id="enabling-the-virtual-host"&gt;Enabling the virtual host&lt;/h3&gt;
&lt;p&gt;Though the configuration file has been created inside the &lt;code&gt;sites-available&lt;/code&gt; folder, the nginx server still does not serve the pages of this site yet. For enabling this, one needs to create a soft link to the config file inside the &lt;code&gt;sites-enabled&lt;/code&gt; folder.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sudo&lt;/span&gt; &lt;span class="n"&gt;ln&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sites&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;available&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sites&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This enables the site on nginx. Once you restart nginx ideally this site should be available.&lt;/p&gt;
&lt;h2 id="setting-up-the-hosts-file"&gt;Setting up the hosts file&lt;/h2&gt;
&lt;p&gt;The last important step is to ensure that the hostname is configured in the DNS server to point to your machine. Since I was using it just for my local development, I went ahead and configured my &lt;code&gt;/etc/hosts&lt;/code&gt; file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="mi"&gt;127&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;  &lt;span class="n"&gt;ex&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nacnez&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Once this is done, we are all set. If you crank up the browser and type in the domain name you must get the content of your index page.&lt;/p&gt;
&lt;p&gt;This was my first encounter with nginx. This was enough for me for my current use of nginx. Hopefully I will get pushed to learn more on nginx and that should be fun.&lt;/p&gt;</content><category term="development"></category><category term="technology"></category><category term="nginx"></category><category term="web"></category></entry></feed>