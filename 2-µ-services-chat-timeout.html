<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>µservices gossip: Take a timeout! - Starting Point</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://www.nacnez.com/2-µ-services-chat-timeout.html">

        <meta name="author" content="Srinivas Narayanan" />
        <meta name="keywords" content="architecture,resilience,microservices,play,bounded contexts" />
        <meta name="description" content="A casual bar chat between µ services Jack and Jill about Jack&#39;s problem with Jill." />

        <meta property="og:site_name" content="Starting Point" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="µservices gossip: Take a timeout!"/>
        <meta property="og:url" content="https://www.nacnez.com/2-µ-services-chat-timeout.html"/>
        <meta property="og:description" content="A casual bar chat between µ services Jack and Jill about Jack&#39;s problem with Jill."/>
        <meta property="article:published_time" content="2019-10-13" />
            <meta property="article:section" content="Microservices" />
            <meta property="article:tag" content="architecture" />
            <meta property="article:tag" content="resilience" />
            <meta property="article:tag" content="microservices" />
            <meta property="article:tag" content="play" />
            <meta property="article:tag" content="bounded contexts" />
            <meta property="article:author" content="Srinivas Narayanan" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://www.nacnez.com/theme/css/bootstrap.cyborg.min.css" type="text/css"/>
    <link href="https://www.nacnez.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://www.nacnez.com/theme/css/pygments/monokai.css" rel="stylesheet">
    <link rel="stylesheet" href="https://www.nacnez.com/theme/css/style.css" type="text/css"/>
        <link href="https://www.nacnez.com/css/custom.css" rel="stylesheet">

        <link href="https://www.nacnez.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Starting Point ATOM Feed"/>

        <link href="https://www.nacnez.com/feeds/microservices.atom.xml" type="application/atom+xml" rel="alternate"
              title="Starting Point Microservices ATOM Feed"/>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-79BTGL1LJS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', G-79BTGL1LJS);
    </script>
    <!-- End Google Analytics Code -->
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NBHLX3B');</script>
    <!-- End Google Tag Manager -->

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="https://www.nacnez.com/" class="navbar-brand">
<img class="img-responsive pull-left gap-right" src="https://www.nacnez.com/images/myLogo.png" width=""/> Starting Point            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://www.nacnez.com/2-µ-services-chat-timeout.html"
                       rel="bookmark"
                       title="Permalink to µservices gossip: Take a timeout!">
                        µservices gossip: Take a timeout!
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-success">6 min. read</span>
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2019-10-13T00:00:00+05:30"> Sun 13 October 2019</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="https://www.nacnez.com/tag/architecture.html">architecture</a>
        /
	<a href="https://www.nacnez.com/tag/resilience.html">resilience</a>
        /
	<a href="https://www.nacnez.com/tag/microservices.html">microservices</a>
        /
	<a href="https://www.nacnez.com/tag/play.html">play</a>
        /
	<a href="https://www.nacnez.com/tag/bounded-contexts.html">bounded contexts</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h4 id="act-1">Act 1</h4>
<p><span class="small-italicized-green"> ------------------------ The curtain opens ------------------------ </span></p>
<p><span class="small-italicized-green"> - Jill µ service is already sitting in the bar. The setting is typical of all bars. It is crowded with a lot of µ services having a good time with drinks and conversations. It is a chatty place. Jack µ service enters, looking haggard. - </span></p>
<p><img alt="A Services Bar" class="figure" src="https://www.nacnez.com/images/ms_conversation_timeout/a_service_bar.jpg" style="width: 2538px; height: auto; max-width: 100%;"/></p>
<p><span class="bold-angry">Jack µ</span>: What a day! Shall I sit here? ... I am going to sit here. Please don't mind.</p>
<p><span class="bold-calm">Jill µ</span>: Go ahead. No problems.</p>
<p><span class="bold-angry">Jack µ</span>: Thank you. I am Jack. Who are you?</p>
<p><span class="bold-calm">Jill µ</span>: I am Jill. Pleased to meet you in person!</p>
<p><span class="bold-angry">Jack µ</span>: Meet you in person? What does that mean? Does that mean that we know each other?</p>
<p><span class="bold-calm">Jill µ</span>: You talk to me all the time professionally, by calling my URI - <code>jill.ourcompany.io</code>. Ring any bells?</p>
<p><span class="bold-angry">Jack µ</span>: Oh yeah. I know you. I send requests to that url, I mean your url all the time. Yeah, I remember.</p>
<p><span class="bold-calm">Jill µ</span>: Told you.</p>
<p><span class="small-italicized-green"> - Jill is smiling. Then Jack's demeanor changes. Looks up agitated &amp; angry - </span></p>
<p><span class="bold-angry">Jack µ</span>: You gave me so much <strong>PAIN</strong> last week. Why did you do that?</p>
<p><span class="small-italicized-green"> - Jill looks at Jack shocked for a moment, but calms herself down - </span></p>
<p><span class="bold-calm">Jill µ</span>: What did I do?</p>
<p><span class="bold-angry">Jack µ</span>: Oh! You don't remember last wednesday. Oh boy! I remember it all.</p>
<p><span class="small-italicized-green"> - A look of understanding comes on Jill's face - </span></p>
<p><span class="bold-calm">Jill µ</span>: Ah! I do remember. It was a bad day. My development guys were all looking at my problem...</p>
<p><span class="small-italicized-green"> - Jack lifts his hand and interrupts Jill - </span></p>
<p><span class="bold-angry">Jack µ</span>: <strong>No, no, no!</strong> It was a <strong>BAD</strong> day for me. I got <strong>sc***ed</strong> because of you. It is all because of you.</p>
<p><span class="bold-calm">Jill µ</span>: Hold on. Let us take it slow. Here, have a drink.</p>
<p><span class="bold-angry">Jack µ</span>: <strong>Don't patronize me</strong>. You did this to me.</p>
<p><span class="bold-calm">Jill µ</span>: What really happened? You need to give me details so that I can understand. Calm down and have this.</p>
<p><span class="small-italicized-green"> - Jill picks up the <code>CPU credits</code> from the counter and hands it to Jack and he takes a swig. Jack looks a bit satiated - </span></p>
<p><span class="bold-angry">Jack µ</span>: Okay. This is what happened. I called you to get the answers I need from you to do my job as usual. I waited for an answer but it never came. And I kept waiting. Then more people asked for the information and I called you again. And you just did not respond. I got all stuck up - all blocked threads; all my servers froze up. I couldn't serve any of my customers. Everyone was shouting &amp; pinging me again &amp; again but, I just couldn't do anything. I lost face because of you.</p>
<p><span class="bold-calm">Jill µ</span>: Ok. Let us talk through this. We are both µ services. We take care of different aspects of the business domain - my developers call it <a href="https://martinfowler.com/bliki/BoundedContext.html">bounded contexts</a>. We work together to ensure that our customer needs are met. Your customers are my customers too. For a given usecase, many times, we have to talk to each other and get things done. And we do that all the time and mostly it is successful.</p>
<p><span class="bold-angry">Jack µ</span>: Yeah, I know that. I am not <strong>d**b</strong>. But on that day, you....</p>
<p><span class="small-italicized-green"> - Jill interrupts Jack - </span></p>
<p><span class="bold-calm">Jill µ</span>: Hold on Jack. Let me finish. We both want the same thing &amp; you need to understand that. But given the nature of the world we live in, it is possible that one of us doesn't work as well at times. Things go wrong with the Infra guys sometimes. Or sometimes our developers make a mistake. And sometimes the Network guy acts up - rare - but that does happen. We are a <a href="https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing">distributed system</a>. We have to live with the problems that come with it.</p>
<p><img alt="Cascading Failures" class="figure" src="https://www.nacnez.com/images/ms_conversation_timeout/dominos.jpg" style="width: 425px; height: auto; max-width: 100%;"/></p>
<p><span class="bold-angry">Jack µ</span>: Yeah, yeah. I understand all that. But I really don't want go down when you go down. I don't like this <span class="bold-angry"> CASCADING of failures </span>. There are many things that I can do to help my customers even when you are down. But since you bring me down with you, I can't serve anyone. I <strong>don't</strong> like it.</p>
<p><span class="bold-calm">Jill µ</span>: I understand that Jack. I appreciate you wanting to be available for our customers. Please believe me. But as I said, things go wrong with us at times. Last week, I heard your DB guy was acting up and you couldn't help your customers. <em>Pitcher µ</em> was complaining about it to me.</p>
<p><span class="bold-angry">Jack µ</span>: Yeah, that did happen. I know it happens to all of us. But I don't want to feel helpless like this.</p>
<p><span class="bold-calm">Jill µ</span>: Let us dig deeper Jack. How do you call me to get your answers?</p>
<p><span class="bold-angry">Jack µ</span>: I call you through your REST endpoint. I make a call with the right parameters and you return back a JSON response almost immediately. That is the way I like it. But that time everything went wrong.</p>
<p><img alt="Timeouts" class="figure" src="https://www.nacnez.com/images/ms_conversation_timeout/timeout.jpg" style="width: 404px; height: auto; max-width: 100%;"/></p>
<p><span class="bold-calm">Jill µ</span>: I got what you are doing now. By the way, do you use <span class="bold-calm"> TIMEOUTS </span> on your side? I mean on your calls to me as a client.</p>
<p><span class="bold-angry">Jack µ</span>: What timeouts? I don't follow you.</p>
<p><span class="bold-calm">Jill µ</span>: Ok. Timeout is the concept of time boxing an operation so that, if things don't work out within that time, you give up and move on to something else. This is employed in many places. Not just in service to service requests, but when getting any resource that is used by µ services like us. We could use timeouts for acquiring a lock, connecting to a database or file system. In all such actions, timeout is good idea.</p>
<p><span class="bold-calm">Jack µ</span>: I don't follow that fully. Can you explain it a bit more?</p>
<p><span class="bold-calm">Jill µ</span>: Sure. Let me take an example of what I do. Whenever I try to connect to a database, I try it for a period of 6 seconds. If something is wrong - I mean the DB could be having some issues or the network could be acting up, I give up on that task temporarily and throw an error for everybody to see and move on to other things. I might try it again, but I don't keep hoping and waiting forever for things to happen in the first call. Am I making sense?</p>
<p><span class="bold-angry">Jack µ</span>: Kind off.... But... But if you give up, then you can't serve the customer needs. I mean you don't have the data to serve the request. Then, what is the point?</p>
<p><span class="bold-calm">Jill µ</span>: You are right. For <em>that</em> request, I can't serve the customer for sure. But I also don't get bogged down by a slow or failed resource or dependency. I can drop that request and serve other requests. This way, I don't have a set of <span class="bold-angry"> blocked threads </span> and won't become completely unresponsive. Isn't that better?</p>
<p><span class="bold-calm">Jack µ</span>: Yeah. It sort of makes sense at a high level. Not sure, how it applies to me though.</p>
<p><span class="bold-calm">Jill µ</span>: You said you call my REST endpoint. That is a http call and you must be using some kind of http client. Almost all good http client libraries whether it is in <a href="https://realpython.com/python-requests/#timeouts">Python</a>, <a href="https://github.com/excon/excon#options">Ruby</a>, <a href="https://www.baeldung.com/httpclient-timeout">Java</a> or any other language, will provide a way to configure timeouts. So go ahead and configure them with some sane values and you are done.</p>
<p><span class="bold-calm">Jack µ</span>: Wow! That is interesting. So what kind of timeouts are involved in http calls?</p>
<p><span class="bold-calm">Jill µ</span>: Typically there are two timeouts that are configured. One is the connection timeout - the time taken for establishing the tcp connection. The other is a read timeout - which is time waiting for data to be received during a read. All these libraries provide the ability to configure both these values. Once you configure them to appropriate values as applicable to you, you are done.</p>
<p><span class="bold-calm">Jack µ</span>: That sounds pretty neat. So you are saying that once I configure myself with these timeouts for my interactions with you, I will be hale, healthy and happy!</p>
<p><span class="bold-calm">Jill µ</span>: Sure. Doing this will be a great step towards your own stability and avoiding <strong>Cascading Failures</strong>.</p>
<p><span class="bold-calm">Jack µ</span>: Okay! This is good. I am finishing this drink and going to talk to my Dev folks right after. I am going to be the stablest µ service in the world. Cheers!!</p>
<p><span class="bold-calm">Jill µ</span>: Cheers!! Have fun buddy! Have a timeout!</p>
<h2 id="music-grows-louder-and-jack-and-jill-go-up-to-the-dance-floor"><span class="small-italicized-green"> Music grows louder and Jack and Jill go up to the dance floor. </span></h2>
<p><span class="small-italicized-green"> ------------------------ The curtain falls ------------------------ </span></p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'nacnez'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "en";

                        this.page.identifier = '2019-10-13-2-µ-services-chat-timeout';
                        this.page.url = 'https://www.nacnez.com/2-µ-services-chat-timeout.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
        <p>
            <img width="100%" class="img-thumbnail" src="https://www.nacnez.com/images/profile.jpeg"/>
        </p>
    <p>
      <strong>About Srinivas Narayanan (Srini)</strong><br/>
        Living in Bengaluru. Husband, father & software engineer. Currently a <span class="bold-green"><a href="https://getsimpl.com/">Simpl</a></span>fier. <br/>This, a place for me to write about anything under the 🌞. <span class="bold-angry">My views are mine alone</span> & not related to any person or organisation including my employer.
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="http://twitter.com/srininara"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
    <li class="list-group-item"><a href="http://github.com/srininara"><i class="fa fa-github-square fa-lg"></i> github</a></li>
    <li class="list-group-item"><a href="https://www.linkedin.com/in/srinivas-narayanan-1912b14/"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
    <li class="list-group-item"><a href="https://www.nacnez.com/feeds/all.atom.xml"><i class="fa fa-rss-square fa-lg"></i> rss</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="https://www.nacnez.com/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group " id="tags">
    <li class="list-group-item tag-1">
      <a href="https://www.nacnez.com/tag/life.html">life</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="https://www.nacnez.com/tag/software-engineering.html">software-engineering</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://www.nacnez.com/tag/microservices.html">microservices</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://www.nacnez.com/tag/architecture.html">architecture</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://www.nacnez.com/tag/technology.html">technology</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="https://www.nacnez.com/tag/people.html">people</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://www.nacnez.com/tag/india.html">India</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://www.nacnez.com/tag/agile.html">agile</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://www.nacnez.com/tag/spirituality.html">spirituality</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="https://www.nacnez.com/tag/process.html">process</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2023 Srinivas Narayanan (Srini)
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://www.nacnez.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://www.nacnez.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://www.nacnez.com/theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'nacnez'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->


</body>
</html>